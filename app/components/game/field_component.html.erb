<div class="field-container" 
     data-game--animation-target="field" 
     data-game--animation-player-id-value="<%= @game_player.id %>">
  
  <%# Left Group: Deck & Status Bar %>
  <div class="field-left-group">
    <div class="field-deck-area" data-game--animation-target="deck">
      <div class="deck-placeholder">
        <div class="deck-count"><%= deck_count %></div>
      </div>
    </div>

    <div class="field-status-area">
      <%= render Game::StatusBarComponent.new(game_player: @game_player) %>
    </div>
  </div>

  <%# Center Group: Field Slots %>
  <div class="field-center-wrapper">
    <div class="field-slots-area">
      <%= tag.div class: "field-slot left-slot",
                  data: {
                    game__animation_target: "slot",
                    position: "left"
                  }.merge(opponent? ? {} : {
                    action: "click->game--board#playCard dragover->game--board#dragover drop->game--board#drop"
                  }) do %>
        <%= render_slot_card(left_slot_card) || tag.div(class: "empty-slot") %>
      <% end %>

      <%= tag.div class: "field-slot center-slot",
                  data: {
                    game__animation_target: "slot",
                    position: "center"
                  }.merge(opponent? ? {} : {
                    action: "click->game--board#playCard dragover->game--board#dragover drop->game--board#drop"
                  }) do %>
        <%= render_slot_card(center_slot_card) || tag.div(class: "empty-slot") %>
      <% end %>

      <%= tag.div class: "field-slot right-slot",
                  data: {
                    game__animation_target: "slot",
                    position: "right"
                  }.merge(opponent? ? {} : {
                    action: "click->game--board#playCard dragover->game--board#dragover drop->game--board#drop"
                  }) do %>
        <%= render_slot_card(right_slot_card) || tag.div(class: "empty-slot") %>
      <% end %>
    </div>
    
    <% unless opponent? %>
      <div class="unit-summon-info">
        <span class="label">SUMMON:</span>
        <span class="value"><%= units_summoned %> / <%= unit_limit %></span>
      </div>
      <div class="field-pending-cost" style="<%= pending_cost_text.present? ? '' : 'visibility: hidden;' %>">
        <span class="label">SAN COST:</span>
        <%= pending_cost_text.presence || "0" %>
      </div>
    <% end %>
  </div>

  <%# Right Group: Graveyard & Banished & Controls %>
  <div class="field-right-stack">
    <div class="field-right-zones">
      <!-- Graveyard -->
      <div class="field-area-wrapper" data-controller="card-list-modal">
        <div class="field-graveyard-area" 
             data-action="click->card-list-modal#open"
             data-game--animation-target="graveyard">
          <div class="field-label">Grave</div>
          <% if graveyard_top_card %>
            <%= render Game::CardComponent.new(card_entity: graveyard_top_card, variant: :field) %>
          <% else %>
            <div class="empty-graveyard">
              <span class="icon">ðŸ’€</span>
            </div>
          <% end %>
        </div>

        <div class="game-modal-overlay hidden" data-card-list-modal-target="modal" data-action="click->card-list-modal#close">
          <div class="game-modal">
            <div class="modal-content <%= 'modal-opponent' if opponent? %>">
              <div class="modal-header">
                <h2><%= opponent? ? "Opponent Graveyard" : "Graveyard" %> (<%= graveyard_cards.count %>)</h2>
                <button class="modal-close-btn" data-action="click->card-list-modal#closeButton">Ã—</button>
              </div>
              <div class="modal-grid">
                <% graveyard_cards.each do |card| %>
                  <%= render Game::CardComponent.new(card_entity: card, variant: :list) %>
                <% end %>
                <% if graveyard_cards.empty? %>
                  <div class="modal-empty-msg">No cards in Graveyard.</div>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Banished -->
      <div class="field-area-wrapper" data-controller="card-list-modal">
        <div class="field-banished-area" data-action="click->card-list-modal#open">
          <div class="field-label">Void</div>
          <% if banished_top_card %>
            <%= render Game::CardComponent.new(card_entity: banished_top_card, variant: :field) %>
          <% else %>
            <div class="empty-banished">
              <span class="icon">ðŸŒ€</span>
            </div>
          <% end %>
        </div>

        <div class="game-modal-overlay hidden" data-card-list-modal-target="modal" data-action="click->card-list-modal#close">
          <div class="game-modal">
            <div class="modal-content <%= 'modal-opponent' if opponent? %>">
              <div class="modal-header">
                <h2><%= opponent? ? "Opponent Banished" : "Banished Zone" %> (<%= banished_cards.count %>)</h2>
                <button class="modal-close-btn" data-action="click->card-list-modal#closeButton">Ã—</button>
              </div>
              <div class="modal-grid">
                <% banished_cards.each do |card| %>
                  <%= render Game::CardComponent.new(card_entity: card, variant: :list) %>
                <% end %>
                <% if banished_cards.empty? %>
                  <div class="modal-empty-msg">No banished cards.</div>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <% if controls? %>
      <%= render Game::ControlsComponent.new(game_player: @game_player) %>
    <% end %>
  </div>

  <% if opponent? %>
    <%# ç›¸æ‰‹ã®å¬å–šäºˆå®šã‚«ãƒ¼ãƒ‰ã‚’éš ã—ä¿ç®¡ã‚¨ãƒªã‚¢ã«é…ç½®ï¼ˆä½ç½®ã‚’æ‚Ÿã‚‰ã›ãªã„ãŸã‚ï¼‰ %>
    <div class="hidden-staging-area hidden" style="display: none;">
      <% all_scheduled_cards.each do |card| %>
        <%= render Game::CardComponent.new(card_entity: card, variant: :field, hidden: true) %>
      <% end %>
    </div>
  <% end %>
</div>

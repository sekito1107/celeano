<div class="field-container">
  <div class="field-deck-area">
    <div class="deck-placeholder">
      <div class="deck-count"><%= deck_count %></div>
    </div>
  </div>

  <div class="field-slots-area">
    <%= tag.div class: "field-slot left-slot",
                **(opponent? ? {} : {
                  data: {
                    position: "left",
                    action: "click->game--board#playCard dragover->game--board#dragover drop->game--board#drop"
                  }
                }) do %>
      <% if left_slot_card %>
        <%= render Game::CardComponent.new(card_entity: left_slot_card, variant: :field) %>
      <% else %>
        <div class="empty-slot"></div>
      <% end %>
    <% end %>

    <%= tag.div class: "field-slot center-slot",
                **(opponent? ? {} : {
                  data: {
                    position: "center",
                    action: "click->game--board#playCard dragover->game--board#dragover drop->game--board#drop"
                  }
                }) do %>
      <% if center_slot_card %>
        <%= render Game::CardComponent.new(card_entity: center_slot_card, variant: :field) %>
      <% else %>
        <div class="empty-slot"></div>
      <% end %>
    <% end %>

    <%= tag.div class: "field-slot right-slot",
                **(opponent? ? {} : {
                  data: {
                    position: "right",
                    action: "click->game--board#playCard dragover->game--board#dragover drop->game--board#drop"
                  }
                }) do %>
      <% if right_slot_card %>
        <%= render Game::CardComponent.new(card_entity: right_slot_card, variant: :field) %>
      <% else %>
        <div class="empty-slot"></div>
      <% end %>
    <% end %>
  </div>

  <div class="field-right-stack">
    <!-- Graveyard -->
    <div class="field-area-wrapper" data-controller="card-list-modal">
      <div class="field-graveyard-area" data-action="click->card-list-modal#open">
        <div class="field-label">Grave</div>
        <% if graveyard_top_card %>
          <%= render Game::CardComponent.new(card_entity: graveyard_top_card, variant: :field) %>
        <% else %>
          <div class="empty-graveyard">
            <span class="icon">ðŸ’€</span>
          </div>
        <% end %>
      </div>

      <div class="game-modal-overlay hidden" data-card-list-modal-target="modal" data-action="click->card-list-modal#close">
        <div class="game-modal">
          <div class="modal-content <%= 'modal-opponent' if opponent? %>">
            <div class="modal-header">
              <h2><%= opponent? ? "Opponent Graveyard" : "Graveyard" %> (<%= graveyard_cards.count %>)</h2>
              <button class="modal-close-btn" data-action="click->card-list-modal#closeButton">Ã—</button>
            </div>
            <div class="modal-grid">
              <% graveyard_cards.each do |card| %>
                <%= render Game::CardComponent.new(card_entity: card, variant: :list) %>
              <% end %>
              <% if graveyard_cards.empty? %>
                <div class="modal-empty-msg">No cards in Graveyard.</div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Banished -->
    <div class="field-area-wrapper" data-controller="card-list-modal">
      <div class="field-banished-area" data-action="click->card-list-modal#open">
        <div class="field-label">Void</div>
        <% if banished_top_card %>
          <%= render Game::CardComponent.new(card_entity: banished_top_card, variant: :field) %>
        <% else %>
          <div class="empty-banished">
            <span class="icon">ðŸŒ€</span>
          </div>
        <% end %>
      </div>

      <div class="game-modal-overlay hidden" data-card-list-modal-target="modal" data-action="click->card-list-modal#close">
        <div class="game-modal">
          <div class="modal-content <%= 'modal-opponent' if opponent? %>">
            <div class="modal-header">
              <h2><%= opponent? ? "Opponent Banished" : "Banished Zone" %> (<%= banished_cards.count %>)</h2>
              <button class="modal-close-btn" data-action="click->card-list-modal#closeButton">Ã—</button>
            </div>
            <div class="modal-grid">
              <% banished_cards.each do |card| %>
                <%= render Game::CardComponent.new(card_entity: card, variant: :list) %>
              <% end %>
              <% if banished_cards.empty? %>
                <div class="modal-empty-msg">No banished cards.</div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

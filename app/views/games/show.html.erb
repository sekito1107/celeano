<%= stylesheet_link_tag "game_board", "data-turbo-track": "reload" %>
<%= stylesheet_link_tag "status_bar", "data-turbo-track": "reload" %>
<%= stylesheet_link_tag "card", "data-turbo-track": "reload" %>

<div class="game-board" data-controller="board" data-action="click->board#clearDetail">
  <div class="game-overlay"></div>
  
  <%# Master-Detail Preview Container %>
  <div id="card-preview-container"></div>

  <!-- Opponent Area -->
  <div class="status-bar-wrapper opponent-status">
    <% if @opponent_game_player %>
      <%= render Game::StatusBarComponent.new(game_player: @opponent_game_player) %>
    <% end %>
  </div>

  <div class="play-mat play-mat-opponent">
    <% if @opponent_game_player %>
      <%= render Game::FieldComponent.new(game_player: @opponent_game_player, viewer: current_user) %>
      <%= render Game::HandComponent.new(game_player: @opponent_game_player, viewer: current_user) %>
    <% else %>
      <div class="flex items-center justify-center h-full">
        <p class="text-xl opacity-50 font-serif">Deep within the library...</p>
      </div>
    <% end %>
  </div>

  <!-- 中央エリア (Battle Logなど将来的に配置) -->
  <div class="center-area flex-grow flex items-center justify-center pointer-events-none">

  </div>

  <!-- Player Area -->
  <div class="status-bar-wrapper player-status">
    <%= render Game::StatusBarComponent.new(game_player: @game_player) %>
  </div>

  <div class="play-mat">
    <%= render Game::FieldComponent.new(game_player: @game_player, viewer: current_user) %>
    <%= render Game::HandComponent.new(game_player: @game_player, viewer: current_user) %>
  </div>

  <!-- Game Over Overlay -->
  <% if @game.finished? %>
    <%= render Game::GameOverOverlayComponent.new(game: @game, current_user: current_user) %>
  <% else %>
    <%# Pre-render a hidden overlay component via WebSocket or logic updates later %>
    <%# Currently only server-side rendered on refresh if finished %>
  <% end %>
</div>
